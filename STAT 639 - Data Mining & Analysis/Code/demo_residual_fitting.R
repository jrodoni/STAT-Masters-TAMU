set.seed(1)
x=seq(-1,1,length=100)
y=x^2+.5*x^3+.1*rnorm(100)
plot(x,y,pch=16)
lines(x,x^2+.5*x^3)
m1=lm(y~I(x^2)-1)
r=m1$residuals
lines(x,m1$fitted.values,col=4)
apply(cbind(x,y,m1$fitted.values),1,function(z) lines(c(z[1],z[1]),c(z[2],z[3]),col=2) )
plot(x,r,pch=16)
m2=lm(r~I(x^3)-1)
lines(x,m2$fitted.values,col=4)
plot(x,y,pch=16)
lines(x,x^2+.5*x^3)
lines(x,m1$fitted.values+m2$fitted.values,col=4)
